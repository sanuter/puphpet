# Begin magento

if $magento_values == undef {
  $magento_values = hiera('magento', false)
}

if hash_key_equals($magento_values, 'install', 1) {
  case $::osfamily {
    'magento': { $cms_package_url = 'https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-1.2.1.deb' }
    default:  { fail('Unrecognized operating system for Magento') }
  }

  $magento_settings = merge($magento_values['settings'], {
    'package_url' => $magento_package_url,
    require       => Class['my_fw::post'],
  })

  create_resources('class', { 'magento' => $magento_settings })
}
